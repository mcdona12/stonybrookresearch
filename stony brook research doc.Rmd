---
title: "Stony Brook Data Cleaning"
author: "Clare McDonald & Viveka Hall-Holt"
date: "12/2/2020"
output: pdf_document
---

```{r setup, include = FALSE}
library(tidyverse)
library(dplyr)
covid_data <- read_csv("~/Stony Brook Research/COVID-19_December 14, 2020_14.40 .csv")
```

# Deleting First Row from each column
It was irrelevant and messed with classification of variables
```{r}
covid_data <- covid_data %>% 
   filter(row_number() > (n() - 673))
```

# Green Variables
```{r}
# Renaming Green variables
covid_data <- covid_data %>%
  rename(Green_Short_A1 = "R-GPTS_Ref_1",
         Green_Short_A2 = "R-GPTS_Ref_2",
         Green_Short_A3 = "R-GPTS_Ref_3",
         Green_Short_A4 = "R-GPTS_Ref_4",
         Green_Short_A5 = "R-GPTS_Ref_5",
         Green_Short_A6 = "R-GPTS_Ref_6",
         Green_Short_A7 = "R-GPTS_Ref_7",
         Green_Short_A8 = "R-GPTS_Ref_8",
         Green_Short_B1 = "R-GPTS_Per_1",
         Green_Short_B2 = "R-GPTS_Per_2",
         Green_Short_B3 = "R-GPTS_Per_3",
         Green_Short_B4 = "R-GPTS_Per_4",
         Green_Short_B5 = "R-GPTS_Per_5",
         Green_Short_B6 = "R-GPTS_Per_6",
         Green_Short_B7 = "R-GPTS_Per_7",
         Green_Short_B8 = "R-GPTS_Per_8")
# fixed renaming up here and just got rid of the "w" originally
```

```{r}
# Recoding Green variables
covid_data <- covid_data %>%
  mutate(Green_Short_A1 = fct_recode(Green_Short_A1, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"),
         Green_Short_A2 = fct_recode(Green_Short_A2, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"),
         Green_Short_A3 = fct_recode(Green_Short_A3, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"),   
         Green_Short_A4 = fct_recode(Green_Short_A4, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"),  
         Green_Short_A5 = fct_recode(Green_Short_A5, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"),  
         Green_Short_A6 = fct_recode(Green_Short_A6, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"),  
         Green_Short_A7 = fct_recode(Green_Short_A7, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"), 
         Green_Short_A8 = fct_recode(Green_Short_A8, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"),
         Green_Short_B1 = fct_recode(Green_Short_B1, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"),
         Green_Short_B2 = fct_recode(Green_Short_B2, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"),   
         Green_Short_B3w = fct_recode(Green_Short_B3, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"),   
         Green_Short_B4w = fct_recode(Green_Short_B4, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"),   
         Green_Short_B5w = fct_recode(Green_Short_B5, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"),   
         Green_Short_B6w = fct_recode(Green_Short_B6, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"),   
         Green_Short_B7w = fct_recode(Green_Short_B7, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"),               
         Green_Short_B8w = fct_recode(Green_Short_B8, 
                                      "0" = "1", "1" = "2", "2" = "3", "3" = "4", "4" = "5"))
# issue - recoding these as factors turns them into character variables
# we can deal with this later after removing NAs and weird values
# sounds good. do you know how to reverse them from being character variables?
# use parse_integer command (see below or google doc)
```

```{r}

```

# COVID Predicted Consequences
```{r}
# renaming variables
covid_data <- covid_data %>%
  rename(COVID_19_2_1_Headache = "COVID-19_2_1",
         COVID_19_2_1_Fever = "COVID-19_2_2",
         COVID_19_2_1_Bodyache = "COVID-19_2_3",
         COVID_19_2_1_Fatigue= "COVID-19_2_4",
         COVID_19_2_1_Neckpain = "COVID-19_2_5",
         COVID_19_2_1_Lossofsleep = "COVID-19_2_6",
         COVID_19_2_1_Lossofappetite = "COVID-19_2_7",
         COVID_19_2_1_Cough = "COVID-19_2_8",
         COVID_19_2_1_Sorethroat = "COVID-19_2_9",
         COVID_19_2_1_Nasalcongestion = "COVID-19_2_10",
         COVID_19_2_1_Breathingproblems = "COVID-19_2_11",
         COVID_19_2_2_getoutofbed = "COVID-19_2_1_1",
         COVID_19_2_2_preparemeals = "COVID-19_2_2_1",
         COVID_19_2_2_performdailyroutines = "COVID-19_2_3_1",
         COVID_19_2_2_leavehome = "COVID-19_2_4_1",
         COVID_19_2_2_concentrateonwork = "COVID-19_2_5_1",
         COVID_19_2_2_completemywork = "COVID-19_2_6_1",
         COVID_19_2_Irritable = "COVID-19_2_1_2",
         COVID_19_2_Helpless = "COVID-19_2_2_2",
         COVID_19_2_Worried = "COVID-19_2_3_2",
         COVID_19_2_Frustrated = "COVID-19_2_4_2",
         COVID_19_2_makingthemworry= "COVID-19_2_1_3",
         COVID_19_2_beingaburden = "COVID-19_2_2_3",
         COVID_19_2_limitingtheirlives = "COVID-19_2_3_3",
         COVID_19_2_needingtodependonthem = "COVID-19_2_4_3",
         COVID_19_2_takecareofpeople = "COVID-19_2_5_2",
         COVID_19_2_spreadinginfectiontothem = "COVID-19_2_6_2",
         COVID_19_2_sufferfinancially = "COVID-19_2_1_4",
         COVID_19_2_personalrelationships = "COVID-19_2_2_4",
         COVID_19_2_foodandhousing = "COVID-19_2_3_4")
  
```

```{r}
# Scoring COVID Consequences variables
```

# Perceived Vulnerability to Disease Scale 

```{r}
# Recoding reversed scoring questions
covid_data <- covid_data %>%
  mutate(PVDS_3 = fct_recode(PVDS_3,
                             "7" = "1", "6" = "2", "5" = "3", "4" = "4", "3" = "5", "2" = "6", "1" = "7"),
         PVDS_5 = fct_recode(PVDS_5,
                             "7" = "1", "6" = "2", "5" = "3", "4" = "4", "3" = "5", "2" = "6", "1" = "7"),
         PVDS_11 = fct_recode(PVDS_11,
                             "7" = "1", "6" = "2", "5" = "3", "4" = "4", "3" = "5", "2" = "6", "1" = "7"),
         PVDS_12 = fct_recode(PVDS_12,
                             "7" = "1", "6" = "2", "5" = "3", "4" = "4", "3" = "5", "2" = "6", "1" = "7"),
         PVDS_13 = fct_recode(PVDS_13,
                             "7" = "1", "6" = "2", "5" = "3", "4" = "4", "3" = "5", "2" = "6", "1" = "7"),
         PVDS_14 = fct_recode(PVDS_14,
                             "7" = "1", "6" = "2", "5" = "3", "4" = "4", "3" = "5", "2" = "6", "1" = "7"))
```

```{r}
# Computing PVDS Scores
covid_data <- covid_data %>%
    mutate(PVDS_1 = parse_integer(as.character(PVDS_1)),
           PVDS_2 = parse_integer(as.character(PVDS_2)),
           PVDS_3 = parse_integer(as.character(PVDS_3)),
           PVDS_4 = parse_integer(as.character(PVDS_4)),
           PVDS_5 = parse_integer(as.character(PVDS_5)),
           PVDS_6 = parse_integer(as.character(PVDS_6)),
           PVDS_7 = parse_integer(as.character(PVDS_7)),
           PVDS_8 = parse_integer(as.character(PVDS_8)),
           PVDS_9 = parse_integer(as.character(PVDS_9)),
           PVDS_10 = parse_integer(as.character(PVDS_10)),
           PVDS_11 = parse_integer(as.character(PVDS_11)),
           PVDS_12 = parse_integer(as.character(PVDS_12)),
           PVDS_13 = parse_integer(as.character(PVDS_13)),
           PVDS_14 = parse_integer(as.character(PVDS_14)),
           PVDS_15 = parse_integer(as.character(PVDS_15))) 

covid_data <- covid_data %>%
  mutate(Factor_1 = PVDS_8 + PVDS_12 + PVDS_2 + PVDS_14 + PVDS_10 + PVDS_5 + PVDS_6,
         Factor_2 = PVDS_7 + PVDS_15 + PVDS_4 + PVDS_9 + PVDS_3 + PVDS_3 + PVDS_1 + 
                                PVDS_13 + PVDS_11,
        Perceived_Infectability = rowMeans(subset(covid_data, select = c(PVDS_8, PVDS_12, PVDS_2, PVDS_14, PVDS_10, PVDS_5, PVDS_6), na.rm = TRUE)),
         Germ_Aversion = rowMeans(subset(covid_data, select = c(PVDS_7, PVDS_15, PVDS_4, PVDS_9, PVDS_3, PVDS_13, PVDS_11), na.rm = TRUE)))
```


# Rotters Locus of Control Variables 
```{r}
# Renaming RLOC variables
covid_data <- covid_data %>%
  rename(RLOC_1 = QID106,
         RLOC_2 = QID107,
         RLOC_3 = QID108,
         RLOC_4 = QID109,
         RLOC_5 = QID110,
         RLOC_6 = QID111,
         RLOC_7 = QID112,
         RLOC_8 = QID113,
         RLOC_9 = QID114,
         RLOC_10 = QID135,
         RLOC_11 = QID136,
         RLOC_12 = QID137,
         RLOC_13 = QID138,
         RLOC_14 = QID139,
         RLOC_15 = QID140,
         RLOC_16 = QID141,
         RLOC_17 = QID142,
         RLOC_18 = QID143,
         RLOC_19 = QID144,
         RLOC_20 = QID145,
         RLOC_21 = QID146,
         RLOC_22 = QID147,
         RLOC_23 = QID148,
         RLOC_24 = QID149,
         RLOC_25 = QID150,
         RLOC_26 = QID151,
         RLOC_27 = QID152,
         RLOC_28 = QID153,
         RLOC_29 = QID154)
```

```{r}
# Recoding RLOC variables
covid_data <- covid_data %>%
  dplyr::mutate(RLOC_2_score = fct_recode(RLOC_2,
                                   "1" = "1", "0" = "2"),
                RLOC_6_score = fct_recode(RLOC_6,
                                   "1" = "1", "0" = "2"),
                RLOC_7_score = fct_recode(RLOC_7,
                                   "1" = "1", "0" = "2"),
                RLOC_9_score = fct_recode(RLOC_9,
                                  "1" = "1", "0" = "2"),
                RLOC_16_score = fct_recode(RLOC_16,
                                   "1" = "1", "0" = "2"),
                RLOC_17_score = fct_recode(RLOC_17,
                                   "1" = "1", "0" = "2"),
                RLOC_18_score = fct_recode(RLOC_18,
                                   "1" = "1", "0" = "2"),
                RLOC_20_score = fct_recode(RLOC_20,
                                  "1" = "1", "0" = "2"),
                RLOC_21_score = fct_recode(RLOC_21,
                                   "1" = "1", "0" = "2"),
                RLOC_23_score = fct_recode(RLOC_23,
                                   "1" = "1", "0" = "2"),
                RLOC_25_score = fct_recode(RLOC_25,
                                   "1" = "1", "0" = "2"),
                RLOC_29_score = fct_recode(RLOC_29,
                                   "1" = "1", "0" = "2"),
                RLOC_3_score = fct_recode(RLOC_3,
                                   "0" = "1", "1" = "2"),
                RLOC_4_score = fct_recode(RLOC_4,
                                   "0" = "1", "1" = "2"),
               RLOC_5_score = fct_recode(RLOC_5,
                                   "0" = "1", "1" = "2"), 
               RLOC_10_score = fct_recode(RLOC_10,
                                   "0" = "1", "1" = "2"), 
               RLOC_11_score = fct_recode(RLOC_11,
                                   "0" = "1", "1" = "2"),
               RLOC_12_score = fct_recode(RLOC_12,
                                   "0" = "1", "1" = "2"),
               RLOC_13_score = fct_recode(RLOC_13,
                                   "0" = "1", "1" = "2"),
               RLOC_15_score = fct_recode(RLOC_15,
                                  "0" = "1", "1" = "2"),
               RLOC_22_score = fct_recode(RLOC_22,
                                   "0" = "1", "1" = "2"),
               RLOC_26_score = fct_recode(RLOC_26,
                                   "0" = "1", "1" = "2"),
               RLOC_28_score = fct_recode(RLOC_28,
                                   "0" = "1", "1" = "2"))
```

```{r}
# Computing RLOC Scores
covid_data <- covid_data %>%
  mutate(RLOC_2_score = parse_integer(as.character(RLOC_2_score)),
         RLOC_3_score = parse_integer(as.character(RLOC_3_score)),
         RLOC_4_score = parse_integer(as.character(RLOC_4_score)),
         RLOC_5_score = parse_integer(as.character(RLOC_5_score)),
         RLOC_6_score = parse_integer(as.character(RLOC_6_score)),
         RLOC_7_score = parse_integer(as.character(RLOC_7_score)),
         RLOC_9_score = parse_integer(as.character(RLOC_9_score)),
         RLOC_10_score = parse_integer(as.character(RLOC_10_score)),
         RLOC_11_score = parse_integer(as.character(RLOC_11_score)),
         RLOC_12_score = parse_integer(as.character(RLOC_12_score)),
         RLOC_13_score = parse_integer(as.character(RLOC_13_score)),
         RLOC_15_score = parse_integer(as.character(RLOC_15_score)),
         RLOC_16_score = parse_integer(as.character(RLOC_16_score)),
         RLOC_17_score = parse_integer(as.character(RLOC_17_score)),
         RLOC_18_score = parse_integer(as.character(RLOC_18_score)),
         RLOC_20_score = parse_integer(as.character(RLOC_20_score)),
         RLOC_21_score = parse_integer(as.character(RLOC_21_score)),
         RLOC_22_score = parse_integer(as.character(RLOC_22_score)),
         RLOC_23_score = parse_integer(as.character(RLOC_23_score)),
         RLOC_25_score = parse_integer(as.character(RLOC_25_score)),
         RLOC_26_score = parse_integer(as.character(RLOC_26_score)),
         RLOC_28_score = parse_integer(as.character(RLOC_28_score)),
         RLOC_29_score = parse_integer(as.character(RLOC_29_score))) %>%
  mutate(Rotters_general = RLOC_5_score + RLOC_9_score + RLOC_11_score + RLOC_13_score + RLOC_15_score +
           RLOC_16_score + RLOC_18_score + RLOC_25_score + RLOC_28_score,
         Rotters_political = RLOC_3_score + RLOC_12_score + RLOC_17_score + RLOC_22_score,
         RLOC_Total_Score = RLOC_2_score + RLOC_3_score + RLOC_4_score + RLOC_5_score + RLOC_6_score +  
           RLOC_7_score + RLOC_9_score + RLOC_10_score + RLOC_11_score + RLOC_12_score + RLOC_13_score + 
           RLOC_15_score + RLOC_16_score + RLOC_17_score + RLOC_18_score + RLOC_20_score + RLOC_21_score + 
           RLOC_22_score + RLOC_23_score + RLOC_25_score + RLOC_26_score + RLOC_28_score + RLOC_29_score)
```

# Need for Closure Scale 

```{r}
covid_data <- covid_data %>%
  mutate(NFCS_1 = parse_integer(as.character(NFCS_1)),
         NFCS_2 = parse_integer(as.character(NFCS_2)),
         NFCS_3 = parse_integer(as.character(NFCS_3)),
         NFCS_4 = parse_integer(as.character(NFCS_4)),
         NFCS_5 = parse_integer(as.character(NFCS_5)),
         NFCS_6 = parse_integer(as.character(NFCS_6)),
         NFCS_7 = parse_integer(as.character(NFCS_7)),
         NFCS_8 = parse_integer(as.character(NFCS_8)),
         NFCS_9 = parse_integer(as.character(NFCS_9)),
         NFCS_10 = parse_integer(as.character(NFCS_10)),
         NFCS_11 = parse_integer(as.character(NFCS_11)),
         NFCS_12 = parse_integer(as.character(NFCS_12)),
         NFCS_13 = parse_integer(as.character(NFCS_13)),
         NFCS_14 = parse_integer(as.character(NFCS_14)),
         NFCS_15 = parse_integer(as.character(NFCS_15))) %>%
  mutate(NFCS_Total_Score = NFCS_1 + NFCS_2 + NFCS_3 + NFCS_4 + NFCS_5 + NFCS_6 + NFCS_7 + NFCS_8 + NFCS_9 + NFCS_10 + NFCS_11 + NFCS_12 + NFCS_13 + NFCS_14 + NFCS_15)
```

